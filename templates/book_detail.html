{% extends "base.html" %}
{% load static %}

{% block content %}
<section>
    <div class="row m-5">
        <div class="col-6 pe-5 text-start">
            <h1>{{ book.title }}</h1>
            <h4 class="my-5">Author: <span class="span_white">{{ book.author }}</span></h4>
            <h4 class="my-5">Price: <span class="span_white"> â‚¬{{ book.price }}</span></h4>
        </div>
        <div class="col-2 mt-4 text-start">
            <br>
            <br>
            <form class="form" action="{% url 'add_to_bag' book.id %}" method="POST">
                {% csrf_token %}
                <div class="row mx-auto">
                    <div class="col-12 text-center">
                                <p class="fs-4 mx-auto"><strong>Quantity:</strong></p>
                                <input class="w-15 qty_input" type="number" name="quantity" value="1" min="1" max="99" data-item_id="{{ book.id }}" id="id_qty_{{ book.id }}">
                    </div>
                    <div class="col-12 text-center">
                        <button class=""><input type="submit" class="btn btn-black rounded-0 text-uppercase" value="add to Bag" style="color: white;"></button>
                    </div>
                    <input type="hidden" name="redirect_url" value="{{ request.path }}">
                </div>
            </form>
        </div>
        <div class="col-3 text-end mt-5">
            <img src="{{ book.image.url }}" alt="{{ book.title }}" style="color:white;" class="w-75" id="book_image">
        </div>
    <div class="row">
            <div class="col-8 text-start">
                <h4 class="mt-5">About the book:</h4>
                <p>{{ book.description }}</p>
            </div>
    </div>
    <div class="row">
            <div class="col-8">
                <h4 class="mt-5">About the author: </h4>
                <p> {{ book.author.info }}</p> 
                <a href="{{ book.author.external_link }}" target="_blank">
                    <p>Click here to read more on Wikipedia</p>
                </a>
            </div>
    
        <div class="col-3 ms-5 text-center">
            <img src="{{ book.author.image.url }}" alt="{{ book.author }}" style="color:white;" class="w-75 my-5">
        </div>
    </div>
    <div>
        {% if request.user.is_superuser %}
            <a href="{% url 'edit_product' book.id %}"><p>Edit Store Info</p></a>
            <a href="{% url 'delete_product' book.id %}"><p>Delete Product from Store</p></a>
        {% endif %}
    </div>
    <div class="row m-5">
        <div class="col-6">
            <h4>Comments</h4>
            {% if comments %}
                {% for comment in comments %} <p>
                    <span class="comment_user fs-4">{{comment.user}}</span> commented :
                    </p>
                    <p class="fs-4"> "{{comment.text}}"</p>
                    <p>{{ comment.created_on|timesince }} ago</p>
                {% endfor %}
            {% else %}
                <p class="fs-4">No comments yet. Be the first, post your thoughts!</p>
            {% endif %}
        </div>
        <div class="col-2 ">
            <h4 class="my-5">Submit a comment</h4>
            <form method="POST" action="" class="my-5"> {% csrf_token %} 
                <textarea id="comment_field" rows="5" cols="50" name="text" placeholder="Have any thoughts on {{ book.title }}? Post a comment!"></textarea>
                <input type="submit" value="Submit">
            </form>
        </div>
    </div>
</section>
{% endblock %}

{% block postloadjs %}
{{ block.super }}
{% include 'includes/quantity_input_script.html' %}
{% endblock %}